# Daily Log

**Date:** 23 January 2026

---

## ููุฎุต ุงููู ุฐุงูุฑุชู

### Chapter 3 Storage and Retrieval 

- Data Structures That Power Your Database

- Hash Indexes

- SSTables and LSM-Trees

- B-Trees

- Comparing B-Trees and LSM-Trees

- Other Indexing Structures

---

## ุงููุดุงูู ุงููู ุนูุฏู

ุงูุง ุจุตุฑุงุญู ููุชู ุงููู ุฏู ูููุณ ู ูุด ุนุงูุฒ ุงุฌุฑู ููู ู ูููุช ุงูููุงู ุฏู ููุฌูุฏ ุชุงูู ููุชุงุจ Database Internals ู ุจููุฑ ุงูุฑุงู ุจุงูุฐุงุช ุงู B Tree 

ุญุงุฌู ููุงู ู ูู ุงู AVL Tree ู ุงู Red-Black Tree ุนุงูุฒ ุงูุชูุฑูู ุนุดุงู ูุงุณููู  ุจุฑุถู 

---
## ุชูุฎูุตู ููู ุฐุงูุฑุชู + ุดุฑุญู
- ุงูุดุฑุญ ุฏู ุงูุง ูุชุจุช ูู ุญุงุฌู ู ุงูุง ุจุฐุงูุฑ ูู ููุทู ูุชุจุช ู ู ุงูุงุฎุฑ ุจุนุชู ู ุดุงุช ููุชุจู md ุจุทุฑููู ูููุณู 
ู ู ุงูุงุฎุฑ ุฎููุชู ูุนููู ููุงุฑูู ุญููู ูุฑูุชูุง ู ุญูุธุชูุง ุชุญุช ุจุญูุซ ูู ุงุญุชุงุฌุช ุงุดูููุง

ููู ู ุฃู ุฏุงุชุง ุจูุฒ ุญุงุฌุชูู ููููู:
1. ุฅููุง ุชุฎุฒู ุงูุฏุงุชุง ููุง ูุฏููุงููุง  
2. ุชุนุฑู ุชุฑุฌุนูุง ููุง ูุทูุจูุง  

ููู ุนูุฏูุง **Storage Engines**ุ ูุฏู ูุงุฒู ูููููุง ูุด ุนุดุงู ูุจูููุง ูู ุงูุตูุฑุ  ููู ูุฃู ูู ูุงุญุฏุฉ ูููู ูุฎุตุตุฉ ุชุนูู ุญุงุฌุฉ ูุนููุฉุ  ููุงุฒู ุฃููู ูุงูู ุนุดุงู ุฃุนุฑู ุฃุฎุชุงุฑ ุงูููุงุณุจ ููู application ุจุชุงุนู  ูุฃูุฏุฑ ุฃุนูู tuning ุญุณุจ ุงูู workload.

### ุทุจ ูุนูู ุฅููุ
ูุนูู ุฅู ูู Engines ูุนูููุฉ ุนุดุงู:
- **Transactional workload**  
  ุฒู ุงููููุฑูุฒ ุงูุนุงุฏูุฉ: `insert`ุ `update`ุ ุฅูุฎ  
- ูุญุงุฌุงุช ุชุงููุฉ ูุนูููุฉ ุนุดุงู:
  **Analytics**  
  ุฒู ุงูุชูุงุฑูุฑ ูุงูุฏุงุชุง ุงููุชูุฑ

ูู ุนููุชูู ูุจุงุฑ ูู ุงูู Engines:
1. **Log-Structured Storage Engines**
2. **Page-Oriented Storage Engines** (ุฒู B-Tree)

---

## Data Structures ุงููู ุดุบุงูุฉ ูุฑุง ุฃู Database

ููุงุฎุฏ ูุซุงู ุจุณูุท.  ุนูุฏูุง ุฏุงุชุง ุจูุฒ ูููุง ุงุชููู functions:

1. `db_set(key, value)`
2. `db_get(key)`

ุฏู ูุนุชุจุฑ **Key-Value Store**  
- ุงูู key ูููู ูุจูู ุฃู ุญุงุฌุฉ  
- ุงูู value ูููู ูุจูู JSON ูุซููุง  

ุงูุฏุงุชุง ุจุชุชุฎุฒู ูุฃููุง:
CSV file separated by comma (,)

---

## ุงูุฃุฏุงุก (ุงูุณุฑุนุฉ)

### `db_set`
ุณุฑูุน ุฌุฏูุง  ูุฃูู ุจุณ ุจูุนูู write ูู ุขุฎุฑ ุงููุงูู  ูุงูู Databases ุจุชุณุชุฎุฏู ุงูุฃุณููุจ ุฏู ูุชูุฑ

### `db_get`
ููุง ุจูู ุงููุดููุฉ ูุงุฒู ุชุฏูุฑ ุนูู ุงูู key ูู ุงููุงูู ููู ุณุทุฑ ุณุทุฑ  ูุนูู ุชูุฑูุจูุง `O(n)`ูุฏู ูุด ูููุณ  ูู ุงูุฏุงุชุง ุงุชุถุงุนูุชุ ููุช ุงูุจุญุซ ููุชุถุงุนู ุญุฑูููุง

---

## ุงูุญู: Index

ุธูุฑ ุนูุฏูุง ุญู ุฒู ุงูู **Index**

ุงูู Index:
- Data structure ุฅุถุงููุฉ  ูููุง metadata ุดุบุงูุฉ ุฒู ุฎุฑูุทุฉ ุชูุตููุง ููุฏุงุชุง ุจุณุฑุนุฉ  

ูููุฉ:
- ูุด ุจุชุฃุซุฑ ุนูู ุงูุฏุงุชุง ููุณูุง ุจุณ ุจุชุฒูุฏ ุงูู performance  

### ุงูุนูุจ
ูู write ูุงุฒู ูุนุฏู ุงูู indexes ูุนูู ุงููุชุงุจุฉ ูุชุจูู ุฃุจุทุฃ

ูุงูุญู ุงูุตุญ:
- ูุนูู **trade-off** ุญุณุจ ุงุญุชูุงุฌ ุงูู application  
- ุนุดุงู ูุฏู ุงูุฏุงุชุง ุจูุฒ ูุด ุจุชุนูู index ุฏุงูููุง  
- ุฅุญูุง ุงููู ุจูุฎุชุงุฑ

---

## Hash Index

ูุณุชุฎุฏูู ูุน **Key-Value Data**  
ูุฏู ูู ุฃุดูุฑ ุฃููุงุน ุงูุฏุงุชุง  
ุฒู:
- `dict`
- `map`

ุบุงูุจูุง ุจูุณุชุฎุฏููุง **HashMap**

### ุงูููุฑุฉ
ูุณุชุฎุฏู HashMap ูู ุงูู memory ูู index

- ุงูุฏุงุชุง ุชุชูุชุจ ูู ูุงูู ุนุงุฏู  
- ุงูู HashMap ูู ุงูู RAM  
- ูู key ุจูุดุงูุฑ ุนูู **byte offset**  
  (ููุงู ุงูู value ุฌูู ุงููุงูู)

### ุงูุนูููุงุช

#### `db_set`
- ููุชุจ ุงูู key-value ูู ุขุฎุฑ ุงููุงูู  
- ูุญุฏูุซ ุงูู HashMap ุจุงูู offset ุงูุฌุฏูุฏ  

#### `db_get`
- ูุฌูุจ ุงูู offset ูู ุงูู HashMap  
- ูุฑูุญ ูุจุงุดุฑุฉ ููููุงู ุฏู ูู ุงููุงูู  
- ูุฑุฌูุน ุงูู value ุนูู ุทูู  

ุงูุทุฑููุฉ ุฏู ูุณุชุฎุฏูุฉ ูู:
**Bitcask**  
ุงูู storage engine ุจุชุงุน **Riak**

### ุงููููุฒุงุช
- ุณุฑูุน ูู:
  - read
  - write

---

## ุงููุดุงูู

### ูู ุงููุงูู ูููุจุฑ ุจูุง ููุงูุฉุ
ุฃููุฏ ูุง

### ุงูุญู
- **Segmentation**
- **Compaction**

#### Segmentation
- ููุณู ุงููุงููุงุช ูู Segments ุจุญุฌู ูุนูู  
- ูู ูุง Segment ูุชููู:
  - ููููู
  - ููุชุญ ูุงุญุฏ ุฌุฏูุฏ  

#### Compaction
- ูุฏูุฌ ุงูุจูุงูุงุช  
- ูุดูู ุงูููู ุงููุฏููุฉ  
- ูุญุชูุธ ุจุขุฎุฑ ูููุฉ ููู key  
ูุนูู ูู key ุงุชูุชุจ 10 ูุฑุงุชุ ูุฎูู ุขุฎุฑ ูุฑุฉ ุจุณ

#### Merging
- ูุนูู compaction  
- ููุนูู merge ูุฃูุชุฑ ูู Segment  
- ูู ุงูู background  

---

## ุงูุจุญุซ ุจูุชู ุฅุฒุงูุ

- ูู Segment ููู HashMap  
- ูุจุญุซ:
  - ูู ุงูุฃุญุฏุซ
  - ุจุนุฏู ุงูุฃูุฏู  
- ุงูุนุฏุฏ ูุด ูุจูุฑ  
- ูุงูุจุญุซ ุณุฑูุน

---

## ูุดุงูู ุฅุถุงููุฉ
- ุญุฏูุฏ ุงูู RAM  
- ุชุชุญู ุจุญุงุฌุงุช ุชุงููุฉ  

ุฃูู ุญุงุฌุฉ:
- ูุฎุฒู snapshot ูู ุงูู HashMap ุนูู ุงูู disk ุจุงุณุชูุฑุงุฑ  

### Concurrency
- ูุณูุญ ุจู write ูุงุญุฏุฉ  
- reads ุนุงุฏู ุจุฑุงุญุชูุง  
- ุจุงุณุชุฎุฏุงู locks

---

## ููู Append-only ุฃุญุณู ูู Overwriteุ

- ุฃุณุฑุน  
- ุฃูุถู ูู:
  - concurrency
  - crash recovery  
- ูููุน:
  - fragmentation  

---

## SSTables and LSM-Trees

### ุงููุดููุฉ
ุงูู RAM ูุด ููุณุชุญูู ูู ุฏู

### SSTable (Sorted String Table)
- ูุงูู ุนูู ุงูู disk  
- ููู key-value pairs  
- ูุชุฑุชุจูู ุญุณุจ ุงูู key  
- ูู key ูุธูุฑ ูุฑุฉ ูุงุญุฏุฉ  

ุงููุฑู:
- Log ุนุงุฏู: ุชุฑุชูุจ writes  
- SSTable: ุชุฑุชูุจ keys  

---

## ุงูููุงูุฏ

### 1. Merging ุฃุณูู
ุจุงุณุชุฎุฏุงู ุญุงุฌุฉ ุฒู:
- merge sort  

ููุฑุง ูุฐุง SSTable  
ูููู ูุชุฑุชุจูู  
ูุฎุชุงุฑ ุฃุตุบุฑ key  
ูููุชุจู ูู ูุงูู ุฌุฏูุฏ  
ููู ูู ุชูุฑุงุฑุ ูุฎุชุงุฑ ุงูุฃุญุฏุซ

### 2. Index ุฃุฎู
- Hash Index: index ููู key  
- SSTable: ูุด ูุญุชุงุฌ ููู key  

ูุซุงู:
- handbag ุนูุฏ offset X  
- handsome ุนูุฏ offset Y  

ุจูุง ุฅู ุงูุฏุงุชุง ูุชุฑุชุจุฉ:
- handiwork ูุงุฒู ูุจูู ุจูููู  
- ูุนูู scan ุตุบูุฑ ูููุตูู ุจุณุฑุนุฉ

### 3. Compression
ุงูุชุฑุชูุจ ุจูุณุงุนุฏ ุฌุฏูุง ูู ุงูุถุบุท

---

## ุงูุชุฑุชูุจ ูู ุงูู Memory
ูุฑุชุจ ุงูุฏุงุชุง ูู ุงูู memory  
ุจุงุณุชุฎุฏุงู:
- Red-Black Tree  
- AVL Tree  

---

## LSM Storage Engine ุจูุดุชุบู ุฅุฒุงูุ

### Writes
ุฃู write:
- ูุชุญุท ูู ุงูู memtable  

ููู ููุณ ุงูููุช:
- ูุชูุชุจ ูู append-only log  
- ุนุดุงู crash recovery  

### Flush to Disk
ููุง ุงูู memtable ุชูุจุฑ:
- ุชุชุญูู ูู SSTable  
- ุชุชูุชุจ ุนูู ุงูุฏูุณู  

ุงููุชุงุจุฉ:
- sequential  
- ุณุฑูุนุฉ ุฌุฏูุง  

ููุชุญ memtable ุฌุฏูุฏุฉ ููุฑูุง

### Reads
ููุง ุชูุฌู ุชูุฑุง key:
1. ุชุจุต ูู memtable  
2. ูู ูุด ููุฌูุฏ:
   - ุฃุญุฏุซ SSTable  
   - ุจุนุฏู ุงูุฃูุฏู  
   - ูููุฐุง  

### Background Compaction
ูู ุงูุฎูููุฉ:
- ูุฏูุฌ SSTables  
- ูุดูู ุงูููู ุงููุฏููุฉ  
- ูุดูู tombstones  
- ูู ุบูุฑ ูุง ูููู ุงููุธุงู  

---

## ูู ุงูุณูุณุชู ููุนุ

### ุงููุดููุฉ
- ุงูู memtable ูู ุงูู RAM  

### ุงูุญู
- ูู write:
  - ูุชูุชุจ ูู WAL (Write-Ahead Log)

ุจุนุฏ restart:
- ููุฑุฃ ุงูู log  
- ูุฑุฌูุน ุงูู memtable  

ููุง ูุนูู flush:
- ููุณุญ ุงูู log  

---

## Range Queries

ุจูุง ุฅู:
- ุงูุฏุงุชุง ูุชุฑุชุจุฉ  

ุชูุฏุฑ ุชุนูู:
- scan ูู key A ูุญุฏ key Z  

ุจููุงุกุฉ ุนุงููุฉ ุฌุฏูุง  

ูุฏู:
- Hash Index ูููุฏุฑุด ูุนููู


## B-Tree

ููุถูุน ููู ุจูุง ููู **B-Tree**  
ุฑุบู ุฅู **LSM Trees** ุญุฏูุซุฉ ููููุฉุ  
ุฅูุง ุฅู **B-Tree** ูุญุฏ ุฏูููุชู ูู ุงูู default index  
ูู ุฃุบูุจ ุงูู Databases

---

## ูุนูู ุฅูู B-Treeุ

ูู **Data Structure**  
ุจุชุฎุฒู **key-value pairs** ูุชุฑุชุจุฉ  
ูุจุชุฏุนู:
- lookup ุณุฑูุน
- range queries  

ูุญุฏ ููุง ุดุจู ุงูู **SSTable**  
ุทุจ ุฅูู ุงูุฌุฏูุฏุ

---

## ููุงุฑูุฉ ุณุฑูุนุฉ: LSM Tree vs B-Tree

### LSM Tree

**Writes**
- append-only
- sequential  

**Disk**
- files ูุจูุฑุฉ (segments)

**Updates**
- lazy  
- ุนู ุทุฑูู compaction  

---

### B-Tree

**Disk**
- ูุชูุณู ูู Pages ุซุงุจุชุฉ ุงูุญุฌู  

**ูู ุนูููุฉ**
- read / write page  

**Updates**
- in-place  
- ุจูุนุฏูู ูู ููุณ ุงูููุงู  

---

## ูุนูู ุฅูู Pagesุ

ูู B-Tree:
- ุงูุฏุงุชุง ูุชูุณูุฉ ูู blocks ุซุงุจุชุฉ ุงูุญุฌู  
- ุบุงูุจูุง:
  - 4 KB  

ูุฏู ุดุจู:
- ุทุฑููุฉ ุงููุงุฑุฏ ููุณู  

### ูุงูุฏุฉ ุฏู
- ูุชูุงูู ุฌุฏูุง ูุน ุงููุงุฑุฏููุฑ  
- efficient ูู random reads  

---

## ุดูู ุงูู B-Tree

ุชุฎูู:
- Tree  

ูู node:
- Page ุนูู ุงูุฏูุณู  

### Root Page
- ุฃูู page ุชุจุฏุฃ ูููุง  
- ูููุง:
  - keys
  - pointers (references) ูุตูุญุงุช ุชุงููุฉ  

---

## ุงูุจุญุซ ูู B-Tree ุจูุชู ุฅุฒุงูุ

ุฎููููุง ููุดู ูุซุงู:

ุฅูุช ุจุชุฏูุฑ ุนูู:
`key = 251`

### Step 1: Root Page
ุชูุงูู ranges ุฒู:
- 0โ100
- 100โ200
- 200โ300  

251 ุจูู:
- 200 ู 300  

ุชูุดู ูู ุงูู pointer ุจุชุงุน ุงูุฑููุฌ ุฏู

---

### Step 2: Internal Page
ุงูุตูุญุฉ ุงูุฌุฏูุฏุฉ:
- ุจุชูุณู 200โ300 ูุฑููุฌุงุช ุฃุตุบุฑ  

ุชุฎุชุงุฑ ุงูุฑููุฌ ุงูููุงุณุจ  
ูุชูุดู pointer ุชุงูู

---

### Step 3: Leaf Page
ุชูุตู ูู:
- Leaf Page  

ุฏู ูููุง:
- ุงูู keys ููุณูุง  
- ููุนุงูุง:
  - ุงูููู  
  - ุฃู pointers ููููู  

### ุนุฏุฏ ุงูุฎุทูุงุช
- ูููู ุฌุฏูุง  
- ุบุงูุจูุง:
  - 3 ุฃู 4 pages ุจุณ  

---

## Branching Factor (ููุทุฉ ูููุฉ)

**Branching Factor**
- ุนุฏุฏ ุงูู child pointers ูู ุงูุตูุญุฉ  

ูู ุงูุญูููุฉ:
- ูุด 5 ุฃู 10  

ููู:
- ูุฆุงุช  

### ูููุ
- ุงูุตูุญุฉ 4 KB  
- ูู key + pointer ุญุฌููู ุตุบูุฑ  
- ูุจุชุดูู ุนุฏุฏ ูุจูุฑ ุฌุฏูุง  

### ุงููุชูุฌุฉ
- Tree ุนูููุง ูููู  
- ุญุชู ูุน ุฏุงุชุง ุถุฎูุฉ ุฌุฏูุง  

---

## ุฃุฑูุงู ุชูุถูุญ ุงูููุฉ

ูุซุงู ูู ุงููุชุงุจ:

- Tree ุนูููุง: 4  
- Page size: 4 KB  
- Branching Factor โ 500  

ุฏู ูุดูู:
- ุญูุงูู 256 TB ุฏุงุชุง  

ูุนูู:
- ุงูุจุญุซ = 4 disk reads ุจุณ  

---

## Update ูู B-Tree

ูู ุนุงูุฒ:
- ุชุนุฏูู value ูู key ููุฌูุฏ  

ุงูุฎุทูุงุช:
1. ุชุฏูุฑ ุนูู ุงูู leaf page  
2. ุชุนุฏูู ุงููููุฉ  
3. ุชูุชุจ ุงูุตูุญุฉ ุชุงูู ุนูู ุงูุฏูุณู  

### ููุงุญุธุงุช
- pointers ุชูุถู valid  
- ูููุด compaction  
- ูููุด merging  

---

## Insert ูู B-Tree

ูู ุนุงูุฒ:
- ุชุถูู key ุฌุฏูุฏ  

### ุงูุญุงูุฉ ุงูุณููุฉ
- ุงูุตูุญุฉ ูููุง ููุงู  
- ุชุถูู ูุฎูุงุต  

### ุงูุญุงูุฉ ุงูุตุนุจุฉ
- ุงูุตูุญุฉ ูููุงูุฉ  

ุงูุญู:
- Page Split  

---

## Page Split (ููุจ ุงูู B-Tree)

ููุง ุงูุตูุญุฉ ุชุชููู:
- ุชุชูุณู ูุตูุญุชูู  
- ูู ูุงุญุฏุฉ ูููุง ูุต ุงูู keys  

### Parent Page
- ูุชุญุฏูุซ  
- ูุถูู pointer ุฌุฏูุฏ  

ูู ุงูู parent page ูููุงูุ
- ูุชูุณู ูู ููุงู  

### ุงููุชูุฌุฉ
- ุงูุดุฌุฑุฉ ุชูุถู balanced  
- ูููุด branch ุฃุทูู ูู ุงูุชุงูู  

---

## ููู B-Tree ุฏุงูููุง Balancedุ

ูุฃู:
- ุฃู insert ุฃู delete  

ุจูุญุงูุธ ุนูู:
- ููุณ ุงูุนูู ููู leaf nodes  

ูุฏู ูุถูู:
- performance ุซุงุจุช  
- `O(log n)`


---

# ููุงุฑูู ูู Chat GPT ุจูู ุงูุงุชููู 

# 1๏ธโฃ ููุงุฑูุฉ ุจูู B-Trees ูLSM-Trees

### **B-Trees**

* Index ุชูููุฏู ููุณุชุฎุฏู ุฌุฏูุง ูู ุฃุบูุจ ุงูู relational databases.
* ูู key ููุฌูุฏ ูู ููุงู ูุงุญุฏ ููุท ูู ุงูู index.
* ูุฑุงุกุฉ ุงูุจูุงูุงุช ุบุงูุจูุง ุฃุณุฑุน ูู LSM-Tree.
* ููุงุณุจ ุฌุฏูุง ูู ุนูุฏู workload ูููุง **reads ูุซูุฑุฉ**.
* Writes:

  * ูุงุฒู ุชูุชุจ ูู data ูุฑุฉ ุนูู ุงูู WAL (Write-Ahead Log) ููุฑุฉ ูู ุงูู B-tree page.
  * ูู ุงูุตูุญุฉ split โ ูููู ุชุถุทุฑ ุชูุชุจ ุตูุญุงุช ุฅุถุงููุฉ.
* **ููุฒุฉ ูุจูุฑุฉ**:

  * predictable performance โ ุงูุฃุฏุงุก ุซุงุจุช ุชูุฑูุจูุงุ ุญุชู ูู ุงูุฏุงุชุง ูุจูุฑุฉ.

### **LSM-Trees**

* Log-structured (Log-structured Merge Trees).
* Writes ุนุงุฏุฉ ุฃุณุฑุน:

  * ุจุณุจุจ sequential writes ุนูู ุงูู SSTables.
  * ุฃูู ุชุฃุซุฑูุง ุจุงูู write amplification ููุงุฑูุฉ ุจู B-trees ุนูู HDDs.
* Reads ุนุงุฏุฉ ุฃุจุทุฃ:

  * ูุงุฒู ุชุดูู ุนุฏุฉ SSTables + memtable + background compactions.
* **ููุฒุฉ**:

  * ูุฏุนู write-heavy workloads ุจุดูู ุฃูุถู.
  * Compression ุฃูุถู โ ุฃูู ูุณุงุญุฉ ุชุฎุฒูู.
* **ุนููุจ**:

  * Compaction ูููู ูุฃุซุฑ ุนูู ุฃุฏุงุก reads/writes ูู ูุด ูุถุจูุท ูููุณ.
  * ูููู ูุชุฑุงูู segments ุบูุฑ ูุฏูุฌุฉ โ ูุดุงูู ูู ุงููุณุงุญุฉ ูุฃุฏุงุก ุงููุฑุงุกุงุช.

**ูุจุฏุฃูููุง ุงููุงุนุฏุฉ**:

> B-Trees ุฃุณุฑุน ูููุฑุงุกุงุชุ LSM-Trees ุฃุณุฑุน ูููุชุงุจุฉ.
> ููู ุงูุฃุฏุงุก ุงูููุงุฆู ูุนุชูุฏ ุนูู **ููุน ุงูู workload**ุ ููุงุฒู ุชุฎุชุจุฑ ุจููุณู.

---

# 2๏ธโฃ Write Amplification (ุงููุฑู ูู ุงููุชุงุจุฉ)

### **B-Trees**

* ุงููุชุงุจุฉ ูุฏ ุชุคุฏู ุฅูู:

  * ูุชุงุจุฉ ุตูุญุฉ ูุงููุฉ ุญุชู ูู ุชุบูุฑุช ุจุณ ุดููุฉ ุจูุงูุงุช.
  * ูุฑุงุช ูุชูุฑ ุชูุชุจ ููุณ ุงูุตูุญุฉ ูุฑุชูู ูุชุฌูุจ ูุดุงูู power failure.
* ูู ุนูุฏู SSD โ ุงูู blocks ูุญุฏูุฏุฉ ูุฑุงุช ุงููุชุงุจุฉ โ write amplification ูุดููุฉ.
* ูุดููุฉ ุฃูุจุฑ ูู ุงูุชุทุจูู **write-heavy**.

### **LSM-Trees**

* ุฃูุถูุง ูู write amplification ุจุณุจุจ ุงูู compaction.
* ููู:

  * ุบุงูุจูุง ุฃูู ูู B-Trees ุนูู SSD/HDD.
  * sequential writes ุฃุณุฑุน ุนูู HDD.
* Compression ุฃูุถู โ ุฃูู ูุณุงุญุฉ โ ุชูููู ุงูู I/O.

---

# 3๏ธโฃ ูููุฒุงุช ูุนููุจ LSM-Trees

### **ูููุฒุงุช**

1. Sustains higher write throughput.
2. Better sequential write performance โ ููุชุงุฒ ุนูู HDD.
3. Compression ุฃูุถู โ ูููุงุช ุฃุตุบุฑ ุนูู ุงูุฏูุณู.
4. Lower storage overhead โ ุจุณุจุจ ุฅุฒุงูุฉ fragmentation ุฃุซูุงุก compaction.
5. ุนูู SSDs โ ุฃูู write amplification ููุงุฆุฏุฉ ูู ุงุณุชุฎุฏุงู ุงูู I/O bandwidth.

### **ุนููุจ**

1. Compaction ูููู ูุชุนุงุฑุถ ูุน ุงููุฑุงุกุงุช ุฃู ุงููุชุงุจุฉ ุงูุฌุงุฑูุฉ.
2. Disk bandwidth ูููู ูุชูุณู ุจูู:

   * initial writes
   * background compaction โ ูููู ูุชุณุจุจ ูู bottleneck.
3. ุฅุฐุง write throughput ุนุงูู ุฌุฏูุง โ segments ุบูุฑ ูุฏูุฌุฉ ุชุฒูุฏ โ ูุคุฏู ููุดุงูู ูุณุงุญุฉ ููุฑุงุกุฉ ุฃุจุทุฃ.

---

# 4๏ธโฃ B-Trees ู Transactions

* **ููุฒุฉ B-Tree**:

  * ูู key ููุฌูุฏ ูู ููุงู ูุงุญุฏ โ ููุชุงุฒ ูู strong transactional semantics.
  * Relational DBs ุชุณุชุฎุฏู ุงูู locks ุนูู key ranges ูุจุงุดุฑุฉ ูู ุงูู B-tree.
* LSM-Trees ูููู ูููู ุนูุฏู ููุณ ุงูู key ูู ุนุฏุฉ segments โ ุฃูู ููุงุณุจุฉ ูุจุนุถ ุงูู transactional workloads.

---

# 5๏ธโฃ Secondary Indexes

* Primary key index โ key ูุฑูุฏ.
* Secondary indexes โ keys ูููู ุชููู ูุด ูุฑูุฏุฉ.
* ุทุฑููุฉ ุงูุชุนุงูู:

  1. ูู key ูู ุงูู index โ list of row IDs (postings list).
  2. ุฃู ุชุฌุนู key ูุฑูุฏ ุจุฅุถุงูุฉ row ID ูู.
* ูููู ุงุณุชุฎุฏุงู B-Trees ุฃู LSM-Trees ูู secondary index.

---

# 6๏ธโฃ Storing values within the index

* Key โ ุงูุจุญุซ ุนููู.
* Value ูููู ูููู:

  1. ุงูู row ููุณู (clustered index).
  2. reference ููู row ูู heap file (non-clustered index).
* Heap file approach:

  * ูููุฏ ููุง ุนูุฏู ุนุฏุฉ secondary indexes โ ุชุฌูุจ ุชูุฑุงุฑ ุงูุจูุงูุงุช.
  * ูู ุงููููุฉ ุจุชูุจุฑ โ ูุงุฒู ุชุญุฑููุง โ update ูู ุงูู indexes ุฃู ุชุณุชุฎุฏู forwarding pointer.

### **Clustered Index**

* Primary key ุบุงูุจูุง clustered โ ุงูุจูุงูุงุช ูุฎุฒูุฉ ุฏุงุฎู ุงูู index ููุณู.
* Secondary indexes โ refer to primary key ููุท.

### **Covering Index**

* Index ูุญุชูู ุนูู ุจุนุถ ุงูุฃุนูุฏุฉ โ ูููู ุชุฌุงูุจ ุนูู query ุจุฏูู ุงูุฐูุงุจ ููู table.
* ูุฒูุฏ ุณุฑุนุฉ ุงููุฑุงุกุฉุ ููู ูุถูู overhead ุนูู ุงููุชุงุจุฉ.

---

# 7๏ธโฃ Multi-column indexes

* Index ุนูู ุฃูุซุฑ ูู ุนููุฏ โ concatenated index:

  * key = col1 + col2 + ... + colN
* ูุซู phonebook โ (lastname, firstname)
* ูููู ุงุณุชุฎุฏุงูู ููุจุญุซ ุนูู ุงูุนููุฏ ุงูุฃูู ุฃู combination ูุนูู.
* **Limitation**:

  * ูุง ูููุนุด ููุจุญุซ ููุท ุนูู ุงูุนููุฏ ุงูุซุงูู ุจุฏูู ุงูุฃูู.

### Multi-dimensional indexes

* ุชุณุชุฎุฏู ููู geospatial ุฃู ุฃุจุนุงุฏ ูุชุนุฏุฏุฉ.
* ูุซุงู: ุงูุจุญุซ ุนู ูุทุงุนู ุถูู latitude ูlongitude ูุญุฏุฏูู.
* ูููู ุชุญููู ุงูู 2D/3D โ 1D ุนุจุฑ space-filling curve ุฃู ุงุณุชุฎุฏุงู R-tree.
* HyperDex ูุณุชุฎุฏู multi-dimensional index (ูุซุงู: date + temperature).

---

# 8๏ธโฃ Full-text search & fuzzy search

* ุงูุจุญุซ ุนู ูููุฉ ูุดุงุจูุฉ ุฃู misspelling โ fuzzy search.
* Lucene:

  * ูุณุชุฎุฏู SSTable-like structure ูููุตุทูุญุงุช.
  * In-memory index ุตุบูุฑ โ ูุชุญุฏูุฏ ููุงู ุงูุจุญุซ ูู ุงููููุงุช.
  * ูููู ุงุณุชุฎุฏุงู automata โ Levenshtein distance.
* Full-text search ูุญุชุงุฌ ูุนุงูุฌุฉ ูุบููุฉ + ุฏุนู synonyms + proximity.

---

# 9๏ธโฃ Keeping everything in memory

* Disk:

  * durable
  * cheaper per GB
* RAM:

  * ุฃุฑุฎุต โ datasets ุตุบูุฑุฉ ูููู ูููุง ูู memory.
* In-memory DB:

  * Reads ูู RAM โ ุณุฑูุน ุฌุฏูุง
  * Disk โ log ุฃู snapshot ููู durability.
* ุฃูุซูุฉ: Redis, VoltDB, MemSQL, Oracle TimesTen, RAMCloud.
* **Anti-caching**:

  * ูู RAM ุฃูู ูู dataset โ evict least-recently-used records โ load on access.
  * ุฒู virtual memory ููู ุนูู ูุณุชูู record ูููุณ page.

---

# ๐ ุงูููุฎุต ุงูุนููู

| Feature                 | B-Tree                    | LSM-Tree                            |
| ----------------------- | ------------------------- | ----------------------------------- |
| Writes                  | Slower                    | Faster (sequential SSTables)        |
| Reads                   | Faster                    | Slower (check multiple segments)    |
| Write Amplification     | Higher on SSD/HDD         | Lower (depends on compaction)       |
| Compression             | Less                      | Better                              |
| Transactional Semantics | Strong (key unique)       | Weaker (keys in multiple segments)  |
| Best For                | Read-heavy, transactional | Write-heavy, append-only, analytics |
| Predictability          | High                      | Medium (depends on compaction)      |
